<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–î–æ–º –±–µ–∑ –∑–∞–±–æ—Ç ‚Äî –ò–Ω–≥–æ—Å—Å—Ç—Ä–∞—Ö</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- –ì–µ—Ä–æ–π—Å–∫–∞—è —Å–µ–∫—Ü–∏—è -->
  <header class="hero-section">
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <div class="hero-logo">
        <div class="logo-icon">üèõÔ∏è</div>
        <h1 class="hero-title">–ò–ù–ì–û–°–°–¢–†–ê–•</h1>
        <div class="hero-subtitle">–ò–º—É—â–µ—Å—Ç–≤–æ –§–∏–∑–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü</div>
      </div>
    </div>
    <div class="hero-decoration">
      <div class="decoration-element"></div>
      <div class="decoration-element"></div>
      <div class="decoration-element"></div>
    </div>
  </header>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <main class="main-content">
    <div class="container">
      <a href="index.html" class="back-button">
        <span>‚Üê</span> <span>–ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É –ø—Ä–æ–¥—É–∫—Ç–æ–≤</span>
      </a>
      <div class="header"><h1 style="margin:0">–î–æ–º –±–µ–∑ –∑–∞–±–æ—Ç</h1></div>

      <div class="card" style="margin-top:20px">
        <div class="h2">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞</div>
        <div class="small-block">
          –ü—Ä–æ–¥—É–∫—Ç –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤ –†–§ –∑–∞–≥–æ—Ä–æ–¥–Ω–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ (–∂–∏–ª–æ–π –¥–æ–º / —Ç–∞—É–Ω—Ö–∞—É—Å), –¥–≤–∏–∂–∏–º–æ–≥–æ –∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.
        </div>
      </div>

      <div class="grid" style="margin-top:20px">
        <div class="card">
          <div class="h2">–û–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</div>

          <div class="box" style="margin-top:12px">
            <div class="h3">–ú–∞—Ç–µ—Ä–∏–∞–ª —Å—Ç–µ–Ω</div>
            <label class="object-label" style="margin:0">
              <input type="radio" name="material" value="wood" checked>
              <span class="object-name">–î–µ—Ä–µ–≤–æ</span>
            </label>
            <label class="object-label" style="margin-left:16px">
              <input type="radio" name="material" value="stone">
              <span class="object-name">–ö–∏—Ä–ø–∏—á / –ö–∞–º–µ–Ω—å</span>
            </label>
          </div>

          <div class="box">
            <label class="object-label" style="margin:0">
              <input type="checkbox" id="hasStove">
              <span class="object-name">–í –¥–æ–º–µ –µ—Å—Ç—å –ø–µ—á—å/–∫–∞–º–∏–Ω/—Å–∞—É–Ω–∞</span>
            </label>
          </div>

          <div class="h2" style="margin-top:20px">–û–±—ä–µ–∫—Ç—ã —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</div>

          <div class="box">
            <label class="object-label">
              <input type="checkbox" id="cov_finish" checked>
              <span class="object-name">–û—Ç–¥–µ–ª–∫–∞ –∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</span>
            </label>
            <div class="input-field" style="margin-left:24px">
              <label for="sum_finish" class="input-label-small">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
              <input id="sum_finish" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="200000">
            </div>

            <div class="risk-groups" style="margin-left:24px">
              <label class="risk-label">
                <input type="checkbox" id="finish_risk1">
                –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 1
              </label>
              <label class="risk-label">
                <input type="checkbox" id="finish_risk23">
                –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 2+3
              </label>
            </div>
          </div>

          <div class="box">
            <label class="object-label">
              <input type="checkbox" id="cov_movable">
              <span class="object-name">–î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ</span>
            </label>
            <div class="input-field" style="margin-left:24px">
              <label for="sum_movable" class="input-label-small">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
              <input id="sum_movable" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="0">
            </div>

            <div class="risk-groups" style="margin-left:24px">
              <label class="risk-label">
                <input type="checkbox" id="mov_risk1">
                –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 1
              </label>
              <label class="risk-label">
                <input type="checkbox" id="mov_risk23">
                –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 2+3
              </label>
            </div>
          </div>

          <div class="box">
            <label class="object-label">
              <input type="checkbox" id="cov_liab" checked>
              <span class="object-name">–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å</span>
            </label>
            <div class="input-field" style="margin-left:24px">
              <label for="sum_liab" class="input-label-small">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
              <input id="sum_liab" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="200000">
            </div>
          </div>

        </div>

        <div class="card">
          <div class="h2">–ò—Ç–æ–≥ —Ä–∞—Å—á—ë—Ç–∞</div>
          <div id="error" class="error"></div>
          <div class="total">–ò—Ç–æ–≥–æ: <span id="total">0</span> ‚ÇΩ</div>

          <div class="box" style="margin-top:12px">
            <div class="h2">–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è</div>
            <div id="details" class="small-block"></div>
          </div>

          <div class="box" style="margin-top:12px" id="risksBlock" style="display:none">
            <div class="h2">–†–∏—Å–∫–∏</div>
            <div class="small-block">
              –ü–æ–∂–∞—Ä, –≤–∑—Ä—ã–≤, –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –≤–æ–¥–æ–π, –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è, –ø—Ä–æ—Ç–∏–≤–æ–ø—Ä–∞–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü, —Å—Ç–∏—Ö–∏–π–Ω–æ–µ –±–µ–¥—Å—Ç–≤–∏–µ, —Ç–µ—Ä–∞–∫—Ç, –∫–æ—Ä–æ—Ç–∫–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ, –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.
            </div>
          </div>

          <div class="box">
            <div class="h2">–ó–∞–ø—Ä–µ—Ç–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã</div>
            <div class="restrictions-list">
              <div class="restriction-item">‚Ä¢ –û–±—ä–µ–∫—Ç—ã –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –†–§ –∏–ª–∏ –Ω–∞ –æ–ø–∞—Å–Ω—ã—Ö —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è—Ö</div>
              <div class="restriction-item">‚Ä¢ –ò–∑–Ω–æ—Å –æ—Ç–¥–µ–ª–∫–∏ –≤—ã—à–µ 70%</div>
              <div class="restriction-item">‚Ä¢ –ê–≤–∞—Ä–∏–π–Ω—ã–µ –¥–æ–º–∞, –ø–æ–¥ —Å–Ω–æ—Å</div>
              <div class="restriction-item">‚Ä¢ –ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</div>
              <div class="restriction-item">‚Ä¢ –î–æ–º–∞ —Å—Ç–∞—Ä—à–µ 60 –ª–µ—Ç –∏–ª–∏ –∫—É–ø–ª–µ–Ω—ã –º–µ–Ω–µ–µ 9 –º–µ—Å—è—Ü–µ–≤ –Ω–∞–∑–∞–¥</div>
              <div class="restriction-item">‚Ä¢ –ù–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–µ–Ω–∏—è, –æ–±—ä–µ–∫—Ç—ã –Ω–∞ –ø—Ä–æ–¥–∞–∂–µ</div>
              <div class="restriction-item">‚Ä¢ –î–æ–ª–µ–≤–∞—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –±–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–∏—è –¥–æ–ª–µ–π</div>
              <div class="restriction-item">‚Ä¢ –û—Ç–¥–µ–ª–∫–∞ –Ω–∞ —Å—Ç–∞–¥–∏–∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ-—Ä–µ–º–æ–Ω—Ç–Ω—ã—Ö —Ä–∞–±–æ—Ç</div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </main>

  <script type="module">
    import { TARIFFS } from './tariffs.dombez.js';

    // helpers
    const fmt = n => new Intl.NumberFormat('ru-RU').format(Math.round(n));
    const fmtSum = n => new Intl.NumberFormat('ru-RU', {
      minimumFractionDigits: 2,
      maximumFractionDigits: 2
    }).format(Number(n));

    // UI elements
    const error = document.getElementById('error');
    const total = document.getElementById('total');
    const details = document.getElementById('details');
    const risksBlock = document.getElementById('risksBlock');

    function findRate(ranges, sum) {
      for (const r of ranges) {
        if (sum >= r.min && sum <= r.max) return r.rate;
      }
      if (ranges.length) return ranges[ranges.length - 1].rate;
      return 0;
    }

    function showBaseRisks() {
      const show = document.getElementById('cov_finish').checked ||
                   document.getElementById('cov_movable').checked;
      risksBlock.style.display = show ? 'block' : 'none';
    }

    function recalc() {
      error.textContent = '';
      total.textContent = '0';
      details.innerHTML = '';

      const mat = document.querySelector('input[name="material"]:checked')?.value || 'wood';
      const stove = document.getElementById('hasStove').checked;

      let totalPremium = 0;
      let detailItems = [];

      // –û—Ç–¥–µ–ª–∫–∞ –∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
      if (document.getElementById('cov_finish').checked) {
        const sum = Number(document.getElementById('sum_finish').value) || 0;
        if (sum > 0) {
          let rate = findRate(TARIFFS.finish[mat], sum);
          if (stove) rate *= TARIFFS.stoveCoefficient;
          const premium = sum * rate;
          totalPremium += premium;
          detailItems.push(`–î–æ–º –±–µ–∑ –∑–∞–±–æ—Ç (–û—Ç–¥–µ–ª–∫–∞ –∏ –∏–Ω–∂. –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ) —Å—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ ${fmtSum(sum)} = ${fmt(premium)} ‚ÇΩ`);

          if (document.getElementById('finish_risk1').checked) {
            const extra = sum * 0.002;
            totalPremium += extra;
            detailItems.push(`‚Äî –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 1: ${fmt(extra)} ‚ÇΩ`);
          }
          if (document.getElementById('finish_risk23').checked) {
            const extra = sum * 0.0015;
            totalPremium += extra;
            detailItems.push(`‚Äî –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 2+3: ${fmt(extra)} ‚ÇΩ`);
          }
        }
      }

      // –î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ
      if (document.getElementById('cov_movable').checked) {
        const sum = Number(document.getElementById('sum_movable').value) || 0;
        if (sum > 0) {
          const rate = findRate(TARIFFS.movable, sum);
          const premium = sum * rate;
          totalPremium += premium;
          detailItems.push(`–î–æ–º –±–µ–∑ –∑–∞–±–æ—Ç (–î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ) —Å—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ ${fmtSum(sum)} = ${fmt(premium)} ‚ÇΩ`);

          if (document.getElementById('mov_risk1').checked) {
            const extra = sum * 0.002;
            totalPremium += extra;
            detailItems.push(`‚Äî –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 1: ${fmt(extra)} ‚ÇΩ`);
          }
          if (document.getElementById('mov_risk23').checked) {
            const extra = sum * 0.0015;
            totalPremium += extra;
            detailItems.push(`‚Äî –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 2+3: ${fmt(extra)} ‚ÇΩ`);
          }
        }
      }

      // –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
      if (document.getElementById('cov_liab').checked) {
        const sum = Number(document.getElementById('sum_liab').value) || 0;
        if (sum > 0) {
          const rate = findRate(TARIFFS.liability, sum);
          const premium = sum * rate;
          totalPremium += premium;
          detailItems.push(`–î–æ–º –±–µ–∑ –∑–∞–±–æ—Ç (–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å) —Å—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ ${fmtSum(sum)} = ${fmt(premium)} ‚ÇΩ`);
        }
      }

      total.textContent = fmt(totalPremium);
      details.innerHTML = detailItems.map(item => `<div>${item}</div>`).join('');
    }

    // events
    const covFinish = document.getElementById('cov_finish');
    const covMovable = document.getElementById('cov_movable');
    const covLiab = document.getElementById('cov_liab');
    const hasStove = document.getElementById('hasStove');
    const sumFinish = document.getElementById('sum_finish');
    const sumMovable = document.getElementById('sum_movable');
    const sumLiab = document.getElementById('sum_liab');
    const finishRisk1 = document.getElementById('finish_risk1');
    const finishRisk23 = document.getElementById('finish_risk23');
    const movRisk1 = document.getElementById('mov_risk1');
    const movRisk23 = document.getElementById('mov_risk23');

    console.log('Event elements found:', !!covFinish, !!covMovable, !!covLiab, !!hasStove, !!sumFinish, !!sumMovable, !!sumLiab);

    if (covFinish) covFinish.addEventListener('change', () => {
      showBaseRisks();
      recalc();
    });
    if (covMovable) covMovable.addEventListener('change', () => {
      showBaseRisks();
      recalc();
    });
    if (covLiab) covLiab.addEventListener('change', recalc);
    if (hasStove) hasStove.addEventListener('change', recalc);
    if (sumFinish) sumFinish.addEventListener('input', recalc);
    if (sumMovable) sumMovable.addEventListener('input', recalc);
    if (sumLiab) sumLiab.addEventListener('input', recalc);
    if (finishRisk1) finishRisk1.addEventListener('change', recalc);
    if (finishRisk23) finishRisk23.addEventListener('change', recalc);
    if (movRisk1) movRisk1.addEventListener('change', recalc);
    if (movRisk23) movRisk23.addEventListener('change', recalc);

    document.getElementsByName('material').forEach(r => {
      if (r) r.addEventListener('change', recalc);
    });

    // init
    showBaseRisks();
    recalc();
  </script>
</body>
</html>
