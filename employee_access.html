<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Employee access ‚Äî —Ä–∞—Å—á—ë—Ç</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <style>
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
  </style>
</head>
<body>
  <!-- –ì–µ—Ä–æ–π—Å–∫–∞—è —Å–µ–∫—Ü–∏—è -->
  <header class="hero-section">
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <div class="hero-logo">
        <div class="logo-icon">üèõÔ∏è</div>
        <h1 class="hero-title">–ò–ù–ì–û–°–°–¢–†–ê–•</h1>
        <div class="hero-subtitle">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ò–§–õ</div>
      </div>
    </div>
    <div class="hero-decoration">
      <div class="decoration-element"></div>
      <div class="decoration-element"></div>
      <div class="decoration-element"></div>
    </div>
  </header>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <main class="main-content">
    <div class="container">
      <a href="index.html" class="back-button">
        <span>‚Üê</span> <span>–ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É –ø—Ä–æ–¥—É–∫—Ç–æ–≤</span>
      </a>
      <div class="header"><h1 style="margin:0">Employee access ‚Äî —Ä–∞—Å—á—ë—Ç</h1></div>

      <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ -->
      <div class="card" style="margin-top:20px">
        <div class="h2">–®–∞–≥ 1: –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</div>
        <div class="property-selection" style="display: flex; gap: 20px; margin-top: 16px;">
          <label class="object-label" style="flex: 1;">
            <input type="radio" name="property_type" value="house" id="property_house" checked>
            <span class="object-name" style="font-size: 18px; font-weight: 500;">üè† –ñ–∏–ª–æ–π –¥–æ–º / –¢–∞—É–Ω—Ö–∞—É—Å</span>
          </label>
          <label class="object-label" style="flex: 1;">
            <input type="radio" name="property_type" value="apartment" id="property_apartment">
            <span class="object-name" style="font-size: 18px; font-weight: 500;">üè¢ –ö–≤–∞—Ä—Ç–∏—Ä–∞</span>
          </label>
        </div>
      </div>

      <!-- –í–≤–æ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –¥–æ–º–∞ -->
      <div id="house_section" class="property-section">
        <div class="card" style="margin-top:20px">
          <div class="h2">–®–∞–≥ 2: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è –¥–æ–º–∞</div>
          <div class="small-block" style="margin-bottom: 16px;">
            –£–∫–∞–∂–∏—Ç–µ —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ —Å—É–º–º—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–µ—Ç –ø—Ä–µ–º–∏–∏ –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–∞–º.
          </div>

          <div class="grid" style="margin-top:16px">
            <div class="card">
              <div class="h2">–û–±—ä–µ–∫—Ç—ã —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</div>

              <div class="box">
                <label class="object-label">
                  <input type="checkbox" id="house_finish" checked>
                  <span class="object-name">–û—Ç–¥–µ–ª–∫–∞ –∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</span>
                </label>
                <div class="input-field" style="margin-left:24px">
                  <label for="house_sum_finish" class="input-label-small">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
                  <input id="house_sum_finish" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="200000">
                </div>

                <div class="risk-groups" style="margin-left:24px">
                  <label class="risk-label">
                    <input type="checkbox" id="house_finish_risk1">
                    –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 1
                  </label>
                  <label class="risk-label">
                    <input type="checkbox" id="house_finish_risk23">
                    –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 2+3
                  </label>
                </div>
              </div>

              <div class="box">
                <label class="object-label">
                  <input type="checkbox" id="house_movable">
                  <span class="object-name">–î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ</span>
                </label>
                <div class="input-field" style="margin-left:24px">
                  <label for="house_sum_movable" class="input-label-small">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
                  <input id="house_sum_movable" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="0">
                </div>

                <div class="risk-groups" style="margin-left:24px">
                  <label class="risk-label">
                    <input type="checkbox" id="house_mov_risk1">
                    –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 1
                  </label>
                  <label class="risk-label">
                    <input type="checkbox" id="house_mov_risk23">
                    –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 2+3
                  </label>
                </div>
              </div>

              <div class="box">
                <label class="object-label">
                  <input type="checkbox" id="house_liab" checked>
                  <span class="object-name">–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å</span>
                </label>
                <div class="input-field" style="margin-left:24px">
                  <label for="house_sum_liab" class="input-label-small">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
                  <input id="house_sum_liab" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="200000">
                </div>
              </div>

            </div>

            <div class="card">
              <div class="h2">–†–∞—Å—á–µ—Ç—ã –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º</div>
              <div id="house_results" class="results-container">
                <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ä–∞—Å—á–µ—Ç—ã -->
              </div>

              <!-- –û–ø—Ü–∏—è –ë–ü–õ–ê -->
              <div class="drone-option" id="house_drone_container" style="margin-top: 20px; padding: 16px; background: #fef3c7; border-radius: 8px; border: 1px solid #f59e0b; transition: all 0.3s ease;">
                <label style="display: flex; align-items: center; cursor: pointer;">
                  <input type="checkbox" id="house_drone_coverage" style="margin-right: 12px; width: 18px; height: 18px;">
                  <span style="font-weight: 500;" id="house_drone_text">üöÅ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –æ—Ç –ë–ü–õ–ê (–ë–∞—Å—Ç–∏–æ–Ω)</span>
                </label>
                <div class="small-block" style="margin-top: 8px;">
                  –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –≤–æ–µ–Ω–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤, –≤–∫–ª—é—á–∞—è –ø–∞–¥–µ–Ω–∏–µ –±–µ—Å–ø–∏–ª–æ—Ç–Ω—ã—Ö –ª–µ—Ç–∞—Ç–µ–ª—å–Ω—ã—Ö –∞–ø–ø–∞—Ä–∞—Ç–æ–≤
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- –í–≤–æ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –∫–≤–∞—Ä—Ç–∏—Ä—ã -->
      <div id="apartment_section" class="property-section" style="display: none;">
        <div class="card" style="margin-top:20px">
          <div class="h2">–®–∞–≥ 2: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è –∫–≤–∞—Ä—Ç–∏—Ä—ã</div>
          <div class="small-block" style="margin-bottom: 16px;">
            –£–∫–∞–∂–∏—Ç–µ —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ —Å—É–º–º—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∂–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –∏ —Ä–∞—Å—á–µ—Ç—ã.
          </div>

          <div class="grid" style="margin-top:16px">
            <div class="card">
              <div class="h2">–û–±—ä–µ–∫—Ç—ã —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</div>

              <div class="box" style="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border: 2px solid #3b82f6; animation: pulse 2s infinite;">
                <label class="object-label">
                  <input type="checkbox" id="apt_constructive">
                  <span class="object-name" style="color: #1e40af; font-weight: 700; font-size: 16px;">üèóÔ∏è –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã</span>
                </label>
                <div class="input-field" style="margin-left:24px; margin-top: 10px;">
                  <label for="apt_sum_constructive" class="input-label-small" style="font-weight: 600;">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
                  <input id="apt_sum_constructive" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="0" style="border: 2px solid #3b82f6;">
                </div>
              </div>

              <div class="box">
                <label class="object-label">
                  <input type="checkbox" id="apt_finish" checked>
                  <span class="object-name">–û—Ç–¥–µ–ª–∫–∞ –∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</span>
                </label>
                <div class="input-field" style="margin-left:24px">
                  <label for="apt_sum_finish" class="input-label-small">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
                  <input id="apt_sum_finish" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="200000">
                </div>
              </div>

              <div class="box">
                <label class="object-label">
                  <input type="checkbox" id="apt_movable">
                  <span class="object-name">–î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ</span>
                </label>
                <div class="input-field" style="margin-left:24px">
                  <label for="apt_sum_movable" class="input-label-small">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
                  <input id="apt_sum_movable" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="0">
                </div>
              </div>

              <div class="box">
                <label class="object-label">
                  <input type="checkbox" id="apt_liab" checked>
                  <span class="object-name">–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å</span>
                </label>
                <div class="input-field" style="margin-left:24px">
                  <label for="apt_sum_liab" class="input-label-small">–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞ (‚ÇΩ):</label>
                  <input id="apt_sum_liab" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" class="sum-input" value="200000">
                </div>
              </div>

            </div>

            <div class="card">
              <div class="h2">–†–∞—Å—á–µ—Ç—ã –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º</div>
              <div id="apartment_results" class="results-container">
                <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ä–∞—Å—á–µ—Ç—ã -->
              </div>

              <!-- –û–ø—Ü–∏—è –ë–ü–õ–ê -->
              <div class="drone-option" id="apartment_drone_container" style="margin-top: 20px; padding: 16px; background: #fef3c7; border-radius: 8px; border: 1px solid #f59e0b; transition: all 0.3s ease;">
                <label style="display: flex; align-items: center; cursor: pointer;">
                  <input type="checkbox" id="apartment_drone_coverage" style="margin-right: 12px; width: 18px; height: 18px;">
                  <span style="font-weight: 500;" id="apartment_drone_text">üöÅ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –æ—Ç –ë–ü–õ–ê (–ë–∞—Å—Ç–∏–æ–Ω)</span>
                </label>
                <div class="small-block" style="margin-top: 8px;">
                  –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –≤–æ–µ–Ω–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤, –≤–∫–ª—é—á–∞—è –ø–∞–¥–µ–Ω–∏–µ –±–µ—Å–ø–∏–ª–æ—Ç–Ω—ã—Ö –ª–µ—Ç–∞—Ç–µ–ª—å–Ω—ã—Ö –∞–ø–ø–∞—Ä–∞—Ç–æ–≤
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </main>

  <script type="module">
    // –ò–º–ø–æ—Ä—Ç —Ç–∞—Ä–∏—Ñ–æ–≤
    import { TARIFFS } from './tariffs.dombez.js';
    import { EXPRESS_PACKS } from './tariffs.express.js';
    import { EXPRESS_GO_PACKS } from './tariffs.express_go.js';
    import * as Platinum from './tariffs.platinum.express.js';
import * as MoyaMod from './tariffs.moyakvartira.js';
import * as BastionMod from './tariffs.bastion.js';

const PRODUCT5_TARIFFS = Platinum.PRODUCT5_TARIFFS || Platinum.TARIFFS || Platinum.default || [];
const T_MOYA = MoyaMod.T_MOYA || MoyaMod.TARIFFS || MoyaMod.default || [];
const T_BASTION = BastionMod.T_BASTION || BastionMod.TARIFFS || BastionMod.default || {};

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let currentPropertyType = 'house';

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    const fmt = n => new Intl.NumberFormat('ru-RU').format(Math.round(n));

    function findRate(ranges, sum) {
    for (const r of ranges) {
      if (sum >= r.min && sum <= r.max) return r.rate;
    }
    if (ranges.length) return ranges[ranges.length - 1].rate;
    return 0;
}

// helper to read possible numeric fields from a pack
function getPackValue(pack, ...keys){
  for(const k of keys){
    if(pack && pack[k] !== undefined && !isNaN(Number(pack[k]))) return Number(pack[k]);
  }
  // try looking for any numeric property
  for(const prop in pack){
    if(!isNaN(Number(pack[prop]))) return Number(pack[prop]);
  }
  return 0;
}


      for (const r of ranges) {
        if (sum >= r.min && sum <= r.max) return r.rate;
      }
      if (ranges.length) return ranges[ranges.length - 1].rate;
      return 0;
    }

    // –§—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è –¥–æ–º–∞ (–î–æ–º –±–µ–∑ –∑–∞–±–æ—Ç)
    function calculateHouseProducts() {
      const results = [];

      const finishChecked = document.getElementById('house_finish')?.checked;
      const movableChecked = document.getElementById('house_movable')?.checked;
      const liabChecked = document.getElementById('house_liab')?.checked;

      const finishSum = Number(document.getElementById('house_sum_finish')?.value) || 0;
      const movableSum = Number(document.getElementById('house_sum_movable')?.value) || 0;
      const liabSum = Number(document.getElementById('house_sum_liab')?.value) || 0;

      const finishRisk1 = document.getElementById('house_finish_risk1')?.checked;
      const finishRisk23 = document.getElementById('house_finish_risk23')?.checked;
      const movRisk1 = document.getElementById('house_mov_risk1')?.checked;
      const movRisk23 = document.getElementById('house_mov_risk23')?.checked;

      // –†–∞—Å—á–µ—Ç –¥–ª—è –î–æ–º –±–µ–∑ –∑–∞–±–æ—Ç
      if (finishChecked || movableChecked || liabChecked) {
        let totalPremium = 0;
        const details = [];

        // –ú–∞—Ç–µ—Ä–∏–∞–ª —Å—Ç–µ–Ω (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–µ—Ä–µ–≤–æ)
        const mat = (document.querySelector('input[name="house_material"]:checked')||{value:'wood'}).value;

        // –û—Ç–¥–µ–ª–∫–∞
        if (finishChecked && finishSum > 0) {
          let rate = findRate(TARIFFS.finish[mat], finishSum);
          const premium = finishSum * rate;
          totalPremium += premium;
          details.push(`–û—Ç–¥–µ–ª–∫–∞: ${fmt(premium)} ‚ÇΩ`);

          if (finishRisk1) {
            const extra = finishSum * 0.002;
            totalPremium += extra;
            details.push(`‚Äî –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 1: ${fmt(extra)} ‚ÇΩ`);
          }
          if (finishRisk23) {
            const extra = finishSum * 0.0015;
            totalPremium += extra;
            details.push(`‚Äî –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 2+3: ${fmt(extra)} ‚ÇΩ`);
          }
        }

        // –î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ
        if (movableChecked && movableSum > 0) {
          const rate = findRate(TARIFFS.movable, movableSum);
          const premium = movableSum * rate;
          totalPremium += premium;
          details.push(`–î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ: ${fmt(premium)} ‚ÇΩ`);

          if (movRisk1) {
            const extra = movableSum * 0.002;
            totalPremium += extra;
            details.push(`‚Äî –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 1: ${fmt(extra)} ‚ÇΩ`);
          }
          if (movRisk23) {
            const extra = movableSum * 0.0015;
            totalPremium += extra;
            details.push(`‚Äî –ì—Ä—É–ø–ø–∞ —Ä–∏—Å–∫–æ–≤ 2+3: ${fmt(extra)} ‚ÇΩ`);
          }
        }

        // –ì–û
        if (liabChecked && liabSum > 0) {
          const rate = findRate(TARIFFS.liability, liabSum);
          const premium = liabSum * rate;
          totalPremium += premium;
          details.push(`–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: ${fmt(premium)} ‚ÇΩ`);
        }

        results.push({
          product: '–î–æ–º –±–µ–∑ –∑–∞–±–æ—Ç',
          total: totalPremium,
          details: details
        });
      }

      return results;
    }

    // –§—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è –∫–≤–∞—Ä—Ç–∏—Ä—ã
    function calculateApartmentProducts() {
      const results = [];

      const constructiveChecked = document.getElementById('apt_constructive')?.checked;
      const finishChecked = document.getElementById('apt_finish')?.checked;
      const movableChecked = document.getElementById('apt_movable')?.checked;
      const liabChecked = document.getElementById('apt_liab')?.checked;

      const constructiveSum = Number(document.getElementById('apt_sum_constructive')?.value) || 0;
      const finishSum = Number(document.getElementById('apt_sum_finish')?.value) || 0;
      const movableSum = Number(document.getElementById('apt_sum_movable')?.value) || 0;
      const liabSum = Number(document.getElementById('apt_sum_liab')?.value) || 0;

      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
      const availableProducts = [];

      if (constructiveChecked) {
        // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤ - –¥–æ—Å—Ç—É–ø–Ω—ã: –ú–æ—è –∫–≤–∞—Ä—Ç–∏—Ä–∞, –≠–∫—Å–ø—Ä–µ—Å—Å –∫–≤–∞—Ä—Ç–∏—Ä–∞, –ü–ª–∞—Ç–∏–Ω—É–º —ç–∫—Å–ø—Ä–µ—Å—Å, –ë–∞—Å—Ç–∏–æ–Ω
        availableProducts.push('my_apartment', 'express_apartment', 'platinum_express');
        if (document.getElementById('apartment_drone_coverage')?.checked) availableProducts.push('bastion');
      } else if (liabChecked && !finishChecked && !movableChecked) {
        // –¢–æ–ª—å–∫–æ –ì–û - –¥–æ—Å—Ç—É–ø–µ–Ω –≠–∫—Å–ø—Ä–µ—Å—Å –ì–û
        availableProducts.push('express_go');
      } else if ((finishChecked || movableChecked) && liabChecked) {
        // –û—Ç–¥–µ–ª–∫–∞/–¥–≤–∏–∂–∏–º–æ–µ + –ì–û - –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã
        availableProducts.push('my_apartment', 'express_apartment', 'express_go', 'platinum_express');
        if (document.getElementById('apartment_drone_coverage')?.checked) availableProducts.push('bastion');
      } else if (finishChecked || movableChecked) {
        // –¢–æ–ª—å–∫–æ –∏–º—É—â–µ—Å—Ç–≤–æ - –¥–æ—Å—Ç—É–ø–Ω—ã –ú–æ—è –∫–≤–∞—Ä—Ç–∏—Ä–∞, –≠–∫—Å–ø—Ä–µ—Å—Å –∫–≤–∞—Ä—Ç–∏—Ä–∞, –ü–ª–∞—Ç–∏–Ω—É–º
        availableProducts.push('my_apartment', 'express_apartment', 'platinum_express');
        if (document.getElementById('apartment_drone_coverage')?.checked) availableProducts.push('bastion');
      }

      // –†–∞—Å—á–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞
      availableProducts.forEach(product => {
        const calculation = calculateProduct(product, constructiveSum, finishSum, movableSum, liabSum, constructiveChecked, finishChecked, movableChecked, liabChecked);
        if (calculation) {
          results.push(calculation);
        }
      });

      return results;
    }

    // –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
    function calculateExpressGO(liabSum) {
      if (liabSum <= 0) return null;

      // –ù–∞–π—Ç–∏ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–∞–∫–µ—Ç –ø–æ —Å—É–º–º–µ –ì–û
      const pack = EXPRESS_GO_PACKS.find(p => p.sum >= liabSum) || EXPRESS_GO_PACKS[EXPRESS_GO_PACKS.length - 1];

      return {
        product: '–≠–∫—Å–ø—Ä–µ—Å—Å –ì–û',
        total: pack.price,
        details: [
          `–°—Ç—Ä–∞—Ö–æ–≤–∞—è —Å—É–º–º–∞: ${fmt(pack.sum)} ‚ÇΩ`,
          `–ü—Ä–µ–º–∏—è: ${fmt(pack.price)} ‚ÇΩ`
        ]
      };
    }

    function calculateExpressApartment(constructiveSum, finishSum, movableSum, liabSum, constructiveChecked, finishChecked, movableChecked, liabChecked) {
      if (!constructiveChecked && !finishChecked && !movableChecked) return null;

      // –≠–∫—Å–ø—Ä–µ—Å—Å –∫–≤–∞—Ä—Ç–∏—Ä–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤ - —Ç–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª–∫—É –∏ –¥–≤–∏–∂–∏–º–æ–µ
      if (constructiveChecked) return null;

      // –ù–∞–π—Ç–∏ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–∞–∫–µ—Ç
      let bestPack = null;
      let bestMatch = 0;

      EXPRESS_PACKS.forEach(pack => {
        let match = 0;
        if (finishChecked && Math.abs(pack.finish - finishSum) < Math.abs((bestPack?.finish || 0) - finishSum)) match++;
        if (movableChecked && Math.abs(pack.movable - movableSum) < Math.abs((bestPack?.movable || 0) - movableSum)) match++;
        if (match > bestMatch) {
          bestMatch = match;
          bestPack = pack;
        }
      });

      if (!bestPack) return null;

      const withGO = liabChecked;
      const price = withGO ? bestPack.withGo : bestPack.noGo;

      const details = [
        `–í–∞—Ä–∏–∞–Ω—Ç ${bestPack.id}`,
        `–û—Ç–¥–µ–ª–∫–∞: ${fmt(bestPack.finish)} ‚ÇΩ`,
        `–î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ: ${bestPack.movable ? fmt(bestPack.movable) + ' ‚ÇΩ' : '–Ω–µ —Å—Ç—Ä–∞—Ö—É–µ—Ç—Å—è'}`
      ];

      if (withGO) {
        details.push(`–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: 50,000 ‚ÇΩ`);
      }

      details.push(`–ü—Ä–µ–º–∏—è: ${fmt(price)} ‚ÇΩ`);

      return {
        product: '–≠–∫—Å–ø—Ä–µ—Å—Å –∫–≤–∞—Ä—Ç–∏—Ä–∞',
        total: price,
        details: details
      };
    }

    function calculatePlatinumExpress(constructiveSum, finishSum, movableSum, liabSum, constructiveChecked, finishChecked, movableChecked, liabChecked) {
      if (!constructiveChecked && !finishChecked && !movableChecked && !liabChecked) return null;

      // –ù–∞–π—Ç–∏ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–∞–∫–µ—Ç –ø–æ —Å—É–º–º–∞–º
      let bestPack = null;
      let bestDiff = Infinity;

      PRODUCT5_TARIFFS.forEach(pack => {
        const pack_ke = getPackValue(pack, 'ke','KE','k_e','konstructive','ke_sum');
        const pack_oo = getPackValue(pack, 'oo','OO','oo_sum','finish','oo_value');
        const pack_di = getPackValue(pack, 'di','DI','di_sum','movable','di_value');
        const pack_go = getPackValue(pack, 'go','GO','go_sum','liab','go_value');

        let totalDiff = 0;
        if (constructiveChecked) totalDiff += Math.abs(pack_ke - constructiveSum);
        if (finishChecked) totalDiff += Math.abs(pack_oo - finishSum);
        if (movableChecked) totalDiff += Math.abs(pack_di - movableSum);
        if (liabChecked) totalDiff += Math.abs(pack_go - liabSum);

        if (totalDiff < bestDiff) {
          bestDiff = totalDiff;
          bestPack = {orig: pack, ke: pack_ke, oo: pack_oo, di: pack_di, go: pack_go};
        }
      });

      if (!bestPack) return null;

      const price = getPackValue(bestPack.orig, 'special', 'special_price', 'sp') || getPackValue(bestPack.orig, 'standard', 'price', 'premium', 'standard_price');

      const details = [];
      if (constructiveChecked && bestPack.ke > 0) details.push(`–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã: ${fmt(bestPack.ke)} ‚ÇΩ`);
      if (finishChecked && bestPack.oo > 0) details.push(`–û—Ç–¥–µ–ª–∫–∞: ${fmt(bestPack.oo)} ‚ÇΩ`);
      if (movableChecked && bestPack.di > 0) details.push(`–î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ: ${fmt(bestPack.di)} ‚ÇΩ`);
      if (liabChecked && bestPack.go > 0) details.push(`–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: ${fmt(bestPack.go)} ‚ÇΩ`);

      if (getPackValue(bestPack.orig,'special','special_price','sp')) {
        details.push('–£—Å–ª–æ–≤–∏—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: –ë–µ–∑—É—Å–ª–æ–≤–Ω–∞—è —Ñ—Ä–∞–Ω—à–∏–∑–∞ –ø–æ –∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ä–∏—Å–∫–∞–º (–±–µ–∑ –ì–û) ‚Äî 10 000 —Ä—É–±. –ø—Ä–∏ –≤—ã–ø–ª–∞—Ç–µ.');
      }

      return {
        product: '–ü–ª–∞—Ç–∏–Ω—É–º –≠–∫—Å–ø—Ä–µ—Å—Å. –ö–≤–∞—Ä—Ç–∏—Ä–∞',
        total: price,
        details: details
      };
    function calculateMyApartment(constructiveSum, finishSum, movableSum, liabSum, constructiveChecked, finishChecked, movableChecked, liabChecked) {
      // –ú–æ—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –≤–∫–ª—é—á–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤
      let total = 0;
      const details = [];

      if (constructiveChecked && constructiveSum > 0) {
        // –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –¥–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–∞
        const rate = constructiveSum > 2000000 ? 0.004 : constructiveSum > 1000000 ? 0.005 : 0.006;
        const premium = constructiveSum * rate;
        total += premium;
        details.push(`–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã: ${fmt(premium)} ‚ÇΩ`);
      }

      if (finishChecked && finishSum > 0) {
        // –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç –¥–ª—è –æ—Ç–¥–µ–ª–∫–∏
        const rate = finishSum > 1000000 ? 0.0052 : finishSum > 500000 ? 0.0060 : 0.0065;
        const premium = finishSum * rate;
        total += premium;
        details.push(`–û—Ç–¥–µ–ª–∫–∞: ${fmt(premium)} ‚ÇΩ`);
      }

      if (movableChecked && movableSum > 0) {
        const premium = movableSum * 0.006;
        total += premium;
        details.push(`–î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ: ${fmt(premium)} ‚ÇΩ`);
      }

      if (liabChecked && liabSum > 0) {
        const rate = liabSum > 500000 ? 0.0022 : 0.0033;
        const premium = liabSum * rate;
        total += premium;
        details.push(`–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: ${fmt(premium)} ‚ÇΩ`);
      }

      if (total === 0) return null;

      return {
        product: '–ú–æ—è –∫–≤–∞—Ä—Ç–∏—Ä–∞',
        total: total,
        details: details
      };
    }

    function calculateBastion(constructiveSum, finishSum, movableSum, constructiveChecked, finishChecked, movableChecked) {
      // –ë–∞—Å—Ç–∏–æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤ –∏ –æ—Ç–¥–µ–ª–∫—É
      let total = 0;
      const details = [];

      if (constructiveChecked && constructiveSum > 0) {
        // –†–∞—Å—á–µ—Ç –¥–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–∞ –≤ –ë–∞—Å—Ç–∏–æ–Ω–µ
        const rate = constructiveSum > 2000000 ? 0.003 : constructiveSum > 1000000 ? 0.004 : 0.005;
        const premium = constructiveSum * rate;
        total += premium;
        details.push(`–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã: ${fmt(premium)} ‚ÇΩ`);
      }

      if (finishChecked && finishSum > 0) {
        // –†–∞—Å—á–µ—Ç –¥–ª—è –æ—Ç–¥–µ–ª–∫–∏ –≤ –ë–∞—Å—Ç–∏–æ–Ω–µ
        const rate = finishSum > 1000000 ? 0.0043 : finishSum > 500000 ? 0.0051 : 0.0065;
        const premium = finishSum * rate;
        total += premium;
        details.push(`–û—Ç–¥–µ–ª–∫–∞: ${fmt(premium)} ‚ÇΩ`);
      }

      if (total === 0) return null;

      return {
        product: '–ë–∞—Å—Ç–∏–æ–Ω (–≤–æ–µ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏)',
        total: total,
        details: details
      };
    }

    function calculateDronePremium(productDetails) {
      // –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ë–ü–õ–ê –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å—É–º–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è
      // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ - 10% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ—Ç–¥–µ–ª–∫–∏
      let dronePremium = 0;

      productDetails.forEach(detail => {
        if (detail.includes('–û—Ç–¥–µ–ª–∫–∞') || detail.includes('–æ—Ç–¥–µ–ª–∫–∞')) {
          // –ò–∑–≤–ª–µ—á—å —Å—É–º–º—É –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞ "–û—Ç–¥–µ–ª–∫–∞: 1,300 ‚ÇΩ"
          const match = detail.match(/: ([\d,]+) ‚ÇΩ/);
          if (match) {
            const amount = parseInt(match[1].replace(/,/g, ''));
            dronePremium += amount * 0.1; // 10% –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ—Ç–¥–µ–ª–∫–∏
          }
        }
      });

      return dronePremium;
    }

    function calculateProduct(productType, constructiveSum, finishSum, movableSum, liabSum, constructiveChecked, finishChecked, movableChecked, liabChecked) {
      switch (productType) {
        case 'express_go':
          return calculateExpressGO(liabSum);
        case 'express_apartment':
          return calculateExpressApartment(constructiveSum, finishSum, movableSum, liabSum, constructiveChecked, finishChecked, movableChecked, liabChecked);
        case 'platinum_express':
          return calculatePlatinumExpress(constructiveSum, finishSum, movableSum, liabSum, constructiveChecked, finishChecked, movableChecked, liabChecked);
        case 'my_apartment':
          return calculateMyApartment(constructiveSum, finishSum, movableSum, liabSum, constructiveChecked, finishChecked, movableChecked, liabChecked);
        case 'bastion':
          return calculateBastion(constructiveSum, finishSum, movableSum, constructiveChecked, finishChecked, movableChecked);
        default:
          return null;
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–∏–ø–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
    function switchPropertyType() {
      const houseRadio = document.getElementById('property_house');
      const apartmentRadio = document.getElementById('property_apartment');

      if (houseRadio.checked) {
        document.getElementById('material_block').style.display = 'block';
        currentPropertyType = 'house';
        document.getElementById('house_section').style.display = 'block';
        document.getElementById('apartment_section').style.display = 'none';
        displayHouseResults();
      } else if (apartmentRadio.checked) {
        document.getElementById('material_block').style.display = 'none';
        currentPropertyType = 'apartment';
        document.getElementById('house_section').style.display = 'none';
        document.getElementById('apartment_section').style.display = 'block';
        console.log('üè¢ –ö–≤–∞—Ä—Ç–∏—Ä–∞ –≤—ã–±—Ä–∞–Ω–∞! –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –ø–µ—Ä–≤–æ–º —á–µ–∫–±–æ–∫—Å–µ.');

        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —á–µ–∫–±–æ–∫—Å–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        const constructiveBox = document.querySelector('#apt_constructive').closest('.box');
        if (constructiveBox) {
          constructiveBox.style.boxShadow = '0 0 20px rgba(59, 130, 246, 0.5)';
          setTimeout(() => {
            constructiveBox.style.boxShadow = '';
          }, 3000);
        }

        // –í—Ä–µ–º–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        setTimeout(() => {
          alert('‚úÖ –ö–≤–∞—Ä—Ç–∏—Ä–∞ –≤—ã–±—Ä–∞–Ω–∞!\n\nüèóÔ∏è –°–º–æ—Ç—Ä–∏—Ç–µ –ü–ï–†–í–´–ô —á–µ–∫–±–æ–∫—Å: "–ö–û–ù–°–¢–†–£–ö–¢–ò–í–ù–´–ï –≠–õ–ï–ú–ï–ù–¢–´"\n\n–û–Ω –º–∏–≥–∞–µ—Ç —Å–∏–Ω–∏–º —Ü–≤–µ—Ç–æ–º!\n\n–ï—Å–ª–∏ –Ω–µ –≤–∏–¥–∏—Ç–µ - –Ω–∞–∂–º–∏—Ç–µ Ctrl+F5 –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è');
        }, 1000);

        displayApartmentResults();
      }
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –¥–æ–º–∞
    function displayHouseResults() {
      const results = calculateHouseProducts();
      const container = document.getElementById('house_results');
      const droneChecked = document.getElementById('house_drone_coverage')?.checked;

      if (results.length === 0) {
        container.innerHTML = '<div class="small-block">–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç –¥–ª—è —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</div>';
        return;
      }

      let html = '';
      results.forEach(result => {
        let total = result.total;

        // –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ë–ü–õ–ê –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –æ–ø—Ü–∏—è
        if (droneChecked && result.product === '–î–æ–º –±–µ–∑ –∑–∞–±–æ—Ç') {
          // add Bastion as separate product when drone selected
          const bastionCalc = calculateBastion(0, Number(document.getElementById('house_sum_finish')?.value)||0, 0, false, true, false);
          if(bastionCalc){
            html += `
  <div class="product-result" style="margin-bottom: 20px; padding: 16px; border: 1px solid #e5e7eb; border-radius: 8px;">
    <div class="h3" style="color: var(--accent); margin-bottom: 12px;">${bastionCalc.product}</div>
    <div class="total" style="margin-bottom: 12px;">–ò—Ç–æ–≥–æ: ${fmt(bastionCalc.total)} ‚ÇΩ</div>
    <div class="details">${bastionCalc.details.map(detail=>`<div class="small-block">${detail}</div>`).join('')}</div>
  </div>`;
          }

          const dronePremium = calculateDronePremium(result.details);
          total += dronePremium;
          result.details.push(`–ë–ü–õ–ê (–ë–∞—Å—Ç–∏–æ–Ω): ${fmt(dronePremium)} ‚ÇΩ`);
        }

        html += `
          <div class="product-result" style="margin-bottom: 20px; padding: 16px; border: 1px solid #e5e7eb; border-radius: 8px;">
            <div class="h3" style="color: var(--accent); margin-bottom: 12px;">${result.product}</div>
            <div class="total" style="margin-bottom: 12px;">–ò—Ç–æ–≥–æ: ${fmt(total)} ‚ÇΩ</div>
            <div class="details">
              ${result.details.map(detail => `<div class="small-block">${detail}</div>`).join('')}
            </div>
          </div>
        `;
      });

      container.innerHTML = html;
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –∫–≤–∞—Ä—Ç–∏—Ä—ã
    function displayApartmentResults() {
      const results = calculateApartmentProducts();
      const container = document.getElementById('apartment_results');
      const droneChecked = document.getElementById('apartment_drone_coverage')?.checked;

      if (results.length === 0) {
        container.innerHTML = '<div class="small-block">–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç –¥–ª—è —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</div>';
        return;
      }

      let html = '';
      results.forEach(result => {
        let total = result.total;

        // –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ë–ü–õ–ê –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –æ–ø—Ü–∏—è
        if (droneChecked && (result.product.includes('–∫–≤–∞—Ä—Ç–∏—Ä–∞') || result.product.includes('–ö–≤–∞—Ä—Ç–∏—Ä–∞'))) {
          const dronePremium = calculateDronePremium(result.details);
          total += dronePremium;
          result.details.push(`–ë–ü–õ–ê (–ë–∞—Å—Ç–∏–æ–Ω): ${fmt(dronePremium)} ‚ÇΩ`);
        }

        html += `
          <div class="product-result" style="margin-bottom: 20px; padding: 16px; border: 1px solid #e5e7eb; border-radius: 8px;">
            <div class="h3" style="color: var(--accent); margin-bottom: 12px;">${result.product}</div>
            <div class="total" style="margin-bottom: 12px;">–ò—Ç–æ–≥–æ: ${fmt(total)} ‚ÇΩ</div>
            <div class="details">
              ${result.details.map(detail => `<div class="small-block">${detail}</div>`).join('')}
            </div>
          </div>
        `;
      });

      container.innerHTML = html;
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', () => {
      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–∏–ø–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
      document.getElementById('property_house').addEventListener('change', switchPropertyType);
      document.getElementById('property_apartment').addEventListener('change', switchPropertyType);

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –¥–æ–º–∞
      ['house_finish', 'house_movable', 'house_liab', 'house_sum_finish', 'house_sum_movable', 'house_sum_liab',
       'house_finish_risk1', 'house_finish_risk23', 'house_mov_risk1', 'house_mov_risk23'].forEach(id => {
        const element = document.getElementById(id);
        if (element) {
          element.addEventListener('change', displayHouseResults);
          element.addEventListener('input', displayHouseResults);
        }
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–≤–∞—Ä—Ç–∏—Ä—ã
      ['apt_constructive', 'apt_finish', 'apt_movable', 'apt_liab', 'apt_sum_constructive', 'apt_sum_finish', 'apt_sum_movable', 'apt_sum_liab'].forEach(id => {
        const element = document.getElementById(id);
        if (element) {
          element.addEventListener('change', displayApartmentResults);
          element.addEventListener('input', displayApartmentResults);
        }
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –æ–ø—Ü–∏–π –ë–ü–õ–ê
      const houseDrone = document.getElementById('house_drone_coverage');
      const apartmentDrone = document.getElementById('apartment_drone_coverage');

      console.log('Drone checkboxes found:', !!houseDrone, !!apartmentDrone);

      if (houseDrone) {
        houseDrone.addEventListener('change', (e) => {
          console.log('House drone checkbox changed:', e.target.checked);
          const container = document.getElementById('house_drone_container');
          const text = document.getElementById('house_drone_text');

          if (container && text) {
            if (e.target.checked) {
              container.style.background = '#d1fae5';
              container.style.borderColor = '#10b981';
              text.textContent = '‚úÖ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –æ—Ç –ë–ü–õ–ê –≤–∫–ª—é—á–µ–Ω–æ!';
              text.style.color = '#059669';
            } else {
              container.style.background = '#fef3c7';
              container.style.borderColor = '#f59e0b';
              text.textContent = 'üöÅ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –æ—Ç –ë–ü–õ–ê (–ë–∞—Å—Ç–∏–æ–Ω)';
              text.style.color = 'inherit';
            }
          }

          displayHouseResults();
        });
      }

      if (apartmentDrone) {
        apartmentDrone.addEventListener('change', (e) => {
          console.log('Apartment drone checkbox changed:', e.target.checked);
          const container = document.getElementById('apartment_drone_container');
          const text = document.getElementById('apartment_drone_text');

          if (e.target.checked) {
            container.style.background = '#d1fae5';
            container.style.borderColor = '#10b981';
            text.textContent = '‚úÖ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –æ—Ç –ë–ü–õ–ê –≤–∫–ª—é—á–µ–Ω–æ!';
            text.style.color = '#059669';
          } else {
            container.style.background = '#fef3c7';
            container.style.borderColor = '#f59e0b';
            text.textContent = 'üöÅ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –æ—Ç –ë–ü–õ–ê (–ë–∞—Å—Ç–∏–æ–Ω)';
            text.style.color = 'inherit';
          }

          displayApartmentResults();
        });
        apartmentDrone.addEventListener('click', (e) => {
          console.log('Apartment drone checkbox clicked');
        });
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      switchPropertyType();
    });
  </script>
</body>
</html>
